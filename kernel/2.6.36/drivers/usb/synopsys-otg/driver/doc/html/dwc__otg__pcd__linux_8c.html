<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: dwc_otg_pcd_linux.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>dwc_otg_pcd_linux.c File Reference</h1>This file implements the Peripheral Controller Driver. <a href="#_details">More...</a>
<p>
<code>#include &lt;linux/kernel.h&gt;</code><br>
<code>#include &lt;linux/module.h&gt;</code><br>
<code>#include &lt;linux/moduleparam.h&gt;</code><br>
<code>#include &lt;linux/init.h&gt;</code><br>
<code>#include &lt;linux/device.h&gt;</code><br>
<code>#include &lt;linux/errno.h&gt;</code><br>
<code>#include &lt;linux/list.h&gt;</code><br>
<code>#include &lt;linux/interrupt.h&gt;</code><br>
<code>#include &lt;linux/string.h&gt;</code><br>
<code>#include &lt;linux/dma-mapping.h&gt;</code><br>
<code>#include &lt;linux/version.h&gt;</code><br>
<code>#include &lt;asm/io.h&gt;</code><br>
<code>#include &lt;linux/usb_ch9.h&gt;</code><br>
<code>#include &lt;linux/usb_gadget.h&gt;</code><br>
<code>#include &quot;<a class="el" href="dwc__otg__pcd__if_8h-source.html">dwc_otg_pcd_if.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="dwc__otg__driver_8h-source.html">dwc_otg_driver.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="dwc__otg__dbg_8h-source.html">dwc_otg_dbg.h</a>&quot;</code><br>

<p>
<a href="dwc__otg__pcd__linux_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgadget__wrapper.html">gadget_wrapper</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb12bc37beddd62e97bf95f1459c646c"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dump_msg" ref="eb12bc37beddd62e97bf95f1459c646c" args="(const u8 *buf, unsigned int length)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dump_msg</b> (const u8 *buf, unsigned int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#9761890d7f741f9421d82254c9846f31">ep_enable</a> (struct usb_ep *usb_ep, const struct usb_endpoint_descriptor *ep_desc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the Gadget Driver for each EP to be configured for the current configuration (SET_CONFIGURATION).  <a href="#9761890d7f741f9421d82254c9846f31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#1708514cb93c5da43a8f634de1c0f5e7">ep_disable</a> (struct usb_ep *usb_ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when an EP is disabled due to disconnect or change in configuration.  <a href="#1708514cb93c5da43a8f634de1c0f5e7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct usb_request *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#e5a3f75b9a06a4707d1d0ec5957daa7d">dwc_otg_pcd_alloc_request</a> (struct usb_ep *ep, gfp_t gfp_flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function allocates a request object to use with the specified endpoint.  <a href="#e5a3f75b9a06a4707d1d0ec5957daa7d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#348338816bfc0e711c4b875997ed00d9">dwc_otg_pcd_free_request</a> (struct usb_ep *ep, struct usb_request *req)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function frees a request object.  <a href="#348338816bfc0e711c4b875997ed00d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#295957efef868247c889aa3f5050af00">dwc_otg_pcd_alloc_buffer</a> (struct usb_ep *usb_ep, unsigned bytes, dma_addr_t *dma, gfp_t gfp_flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function allocates an I/O buffer to be used for a transfer to/from the specified endpoint.  <a href="#295957efef868247c889aa3f5050af00"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#675a197388a82da27f74c11ffdbf874b">dwc_otg_pcd_free_buffer</a> (struct usb_ep *usb_ep, void *buf, dma_addr_t dma, unsigned bytes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function frees an I/O buffer that was allocated by alloc_buffer.  <a href="#675a197388a82da27f74c11ffdbf874b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#f97bea831037135af73c3c202e3e01dc">ep_queue</a> (struct usb_ep *usb_ep, struct usb_request *usb_req, gfp_t gfp_flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is used to submit an I/O Request to an EP.  <a href="#f97bea831037135af73c3c202e3e01dc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e2e4913a926acc55f4e57c3ff8f97c08"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::ep_dequeue" ref="e2e4913a926acc55f4e57c3ff8f97c08" args="(struct usb_ep *usb_ep, struct usb_request *usb_req)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#e2e4913a926acc55f4e57c3ff8f97c08">ep_dequeue</a> (struct usb_ep *usb_ep, struct usb_request *usb_req)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function cancels an I/O request from an EP. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#8ee99e0e68c8e50e94c242805b158cb2">ep_halt</a> (struct usb_ep *usb_ep, int value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">usb_ep_set_halt stalls an endpoint.  <a href="#8ee99e0e68c8e50e94c242805b158cb2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#eb3df484c8c344613a2a9b23e24036a8">iso_ep_start</a> (struct usb_ep *usb_ep, struct usb_iso_request *req, gfp_t gfp_flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is used to submit an ISOC Transfer Request to an EP.  <a href="#eb3df484c8c344613a2a9b23e24036a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cecdcaa060d30ac09414419545a5d1c6"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::iso_ep_stop" ref="cecdcaa060d30ac09414419545a5d1c6" args="(struct usb_ep *usb_ep, struct usb_iso_request *req)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#cecdcaa060d30ac09414419545a5d1c6">iso_ep_stop</a> (struct usb_ep *usb_ep, struct usb_iso_request *req)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function stops ISO EP Periodic Data Transfer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="94fd50b5e9d41d1d38a503d819fc07c4"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::alloc_iso_request" ref="94fd50b5e9d41d1d38a503d819fc07c4" args="(struct usb_ep *ep, int packets, gfp_t gfp_flags)" -->
static struct usb_iso_request *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#94fd50b5e9d41d1d38a503d819fc07c4">alloc_iso_request</a> (struct usb_ep *ep, int packets, gfp_t gfp_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a9a7bc869bc7f3d05804059f3277d11a"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::free_iso_request" ref="a9a7bc869bc7f3d05804059f3277d11a" args="(struct usb_ep *ep, struct usb_iso_request *req)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#a9a7bc869bc7f3d05804059f3277d11a">free_iso_request</a> (struct usb_ep *ep, struct usb_iso_request *req)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7af23be44d3ad24c67cd1e22579dd90e"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::get_frame_number" ref="7af23be44d3ad24c67cd1e22579dd90e" args="(struct usb_gadget *gadget)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#7af23be44d3ad24c67cd1e22579dd90e">get_frame_number</a> (struct usb_gadget *gadget)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the USB Frame number of the last SOF. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#6a6034564b7cc6d8cebfbe02a944cd2c">wakeup</a> (struct usb_gadget *gadget)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiates Session Request Protocol (SRP) to wakeup the host if no session is in progress.  <a href="#6a6034564b7cc6d8cebfbe02a944cd2c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4a1481839b3d869d882f984a6c6ed9e5"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_setup" ref="4a1481839b3d869d882f984a6c6ed9e5" args="(dwc_otg_pcd_t *pcd, uint8_t *bytes)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#4a1481839b3d869d882f984a6c6ed9e5">_setup</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, uint8_t *bytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="737e47386e05da8cf6cbf85a289f5454"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_isoc_complete" ref="737e47386e05da8cf6cbf85a289f5454" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *req_handle, int proc_buf_num)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#737e47386e05da8cf6cbf85a289f5454">_isoc_complete</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *req_handle, int proc_buf_num)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e1d629bc692aa1e42584459867b1aeaa"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_complete" ref="e1d629bc692aa1e42584459867b1aeaa" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *req_handle, int32_t status, uint32_t actual)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#e1d629bc692aa1e42584459867b1aeaa">_complete</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *req_handle, int32_t status, uint32_t actual)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c7c1c4f8fe8e62f1d9e6f75de5563658"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_connect" ref="c7c1c4f8fe8e62f1d9e6f75de5563658" args="(dwc_otg_pcd_t *pcd, int speed)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#c7c1c4f8fe8e62f1d9e6f75de5563658">_connect</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, int speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="682f9829330d06521a5d4c00702e4580"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_disconnect" ref="682f9829330d06521a5d4c00702e4580" args="(dwc_otg_pcd_t *pcd)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#682f9829330d06521a5d4c00702e4580">_disconnect</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="86cdfe71d125da339e17e52049fc5ea0"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_resume" ref="86cdfe71d125da339e17e52049fc5ea0" args="(dwc_otg_pcd_t *pcd)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#86cdfe71d125da339e17e52049fc5ea0">_resume</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7f479ecaee0801b55b4f0bd0f36f8b67"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_suspend" ref="7f479ecaee0801b55b4f0bd0f36f8b67" args="(dwc_otg_pcd_t *pcd)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#7f479ecaee0801b55b4f0bd0f36f8b67">_suspend</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9e8595e1d36e6b1ffbc27c4862957a08"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_hnp_changed" ref="9e8595e1d36e6b1ffbc27c4862957a08" args="(dwc_otg_pcd_t *pcd)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#9e8595e1d36e6b1ffbc27c4862957a08">_hnp_changed</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function updates the otg values in the gadget structure. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="208cf9e0227e5f81e015ed3ac5bacec4"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::_reset" ref="208cf9e0227e5f81e015ed3ac5bacec4" args="(dwc_otg_pcd_t *pcd)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#208cf9e0227e5f81e015ed3ac5bacec4">_reset</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0ac432e212bd3ffbab9b29b1bf999fe4"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_irq" ref="0ac432e212bd3ffbab9b29b1bf999fe4" args="(int irq, void *dev)" -->
static irqreturn_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#0ac432e212bd3ffbab9b29b1bf999fe4">dwc_otg_pcd_irq</a> (int irq, void *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is the top level PCD interrupt handler. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#647f81bc0edc9007af3ff2ba04e884f3">gadget_add_eps</a> (struct <a class="el" href="structgadget__wrapper.html">gadget_wrapper</a> *d)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function initialized the usb_ep structures to there default state.  <a href="#647f81bc0edc9007af3ff2ba04e884f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#6cbde69780790137d41fd45558236000">dwc_otg_pcd_gadget_release</a> (struct device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function releases the Gadget device.  <a href="#6cbde69780790137d41fd45558236000"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e0f94c48914d5f911f7623a53c5385a9"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::alloc_wrapper" ref="e0f94c48914d5f911f7623a53c5385a9" args="()" -->
static struct <a class="el" href="structgadget__wrapper.html">gadget_wrapper</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#e0f94c48914d5f911f7623a53c5385a9">alloc_wrapper</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8893dc41eae659439546d874c6e9977f"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::free_wrapper" ref="8893dc41eae659439546d874c6e9977f" args="(struct gadget_wrapper *d)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#8893dc41eae659439546d874c6e9977f">free_wrapper</a> (struct <a class="el" href="structgadget__wrapper.html">gadget_wrapper</a> *d)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9dbc565a7942db0adbf1ec341db22901"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::pcd_init" ref="9dbc565a7942db0adbf1ec341db22901" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#9dbc565a7942db0adbf1ec341db22901">pcd_init</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function initialized the PCD portion of the driver. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="03129ea5120095af86c98558792aeae8"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::pcd_remove" ref="03129ea5120095af86c98558792aeae8" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#03129ea5120095af86c98558792aeae8">pcd_remove</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cleanup the PCD. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#8c1ba129028b3b16909973eb30b85d2c">usb_gadget_register_driver</a> (struct usb_gadget_driver *driver)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function registers a gadget driver with the PCD.  <a href="#8c1ba129028b3b16909973eb30b85d2c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="91e3d41e4501e626f0fa1418c7c2c1b7"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::EXPORT_SYMBOL" ref="91e3d41e4501e626f0fa1418c7c2c1b7" args="(usb_gadget_register_driver)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>EXPORT_SYMBOL</b> (usb_gadget_register_driver)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#fa4a24d0806fbb6e3135d27d24a6a00d">usb_gadget_unregister_driver</a> (struct usb_gadget_driver *driver)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function unregisters a gadget driver.  <a href="#fa4a24d0806fbb6e3135d27d24a6a00d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0b678ae7db0add99e06907852056838f"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::EXPORT_SYMBOL" ref="0b678ae7db0add99e06907852056838f" args="(usb_gadget_unregister_driver)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>EXPORT_SYMBOL</b> (usb_gadget_unregister_driver)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct usb_isoc_ep_ops&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#8d23bf781df0ba0fb4a0133d08c09dc1">dwc_otg_pcd_ep_ops</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct usb_gadget_ops&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#592a942ef237021f608d03dd8b57bc54">dwc_otg_pcd_ops</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structdwc__otg__pcd__function__ops.html">dwc_otg_pcd_function_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd__linux_8c.html#9ce9b5e49c60906c189bee157dd68acd">fops</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This file implements the Peripheral Controller Driver. 
<p>
The Peripheral Controller Driver (PCD) is responsible for translating requests from the Function Driver into the appropriate actions on the DWC_otg controller. It isolates the Function Driver from the specifics of the controller by providing an API to the Function Driver.<p>
The Peripheral Controller Driver for Linux will implement the Gadget API, so that the existing Gadget drivers can be used. (Gadget Driver is the Linux terminology for a Function Driver.)<p>
The Linux Gadget API is defined in the header file <code>&lt;linux/usb_gadget.h&gt;</code>. The USB EP operations API is defined in the structure <code>usb_ep_ops</code> and the USB Controller API is defined in the structure <code>usb_gadget_ops</code>. 
<p>
Definition in file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="9761890d7f741f9421d82254c9846f31"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::ep_enable" ref="9761890d7f741f9421d82254c9846f31" args="(struct usb_ep *usb_ep, const struct usb_endpoint_descriptor *ep_desc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ep_enable           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct usb_endpoint_descriptor *&nbsp;</td>
          <td class="paramname"> <em>ep_desc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called by the Gadget Driver for each EP to be configured for the current configuration (SET_CONFIGURATION). 
<p>
This function initializes the dwc_otg_ep_t data structure, and then calls dwc_otg_ep_activate. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00121">121</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="1708514cb93c5da43a8f634de1c0f5e7"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::ep_disable" ref="1708514cb93c5da43a8f634de1c0f5e7" args="(struct usb_ep *usb_ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ep_disable           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when an EP is disabled due to disconnect or change in configuration. 
<p>
Any pending requests will terminate with a status of -ESHUTDOWN.<p>
This function modifies the dwc_otg_ep_t data structure for this EP, and then calls dwc_otg_ep_deactivate. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00170">170</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="e5a3f75b9a06a4707d1d0ec5957daa7d"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_alloc_request" ref="e5a3f75b9a06a4707d1d0ec5957daa7d" args="(struct usb_ep *ep, gfp_t gfp_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct usb_request* dwc_otg_pcd_alloc_request           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfp_t&nbsp;</td>
          <td class="paramname"> <em>gfp_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function allocates a request object to use with the specified endpoint. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ep</em>&nbsp;</td><td>The endpoint to be used with with the request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gfp_flags</em>&nbsp;</td><td>the GFP_* flags to use. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00196">196</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="348338816bfc0e711c4b875997ed00d9"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_free_request" ref="348338816bfc0e711c4b875997ed00d9" args="(struct usb_ep *ep, struct usb_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dwc_otg_pcd_free_request           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct usb_request *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function frees a request object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ep</em>&nbsp;</td><td>The endpoint associated with the request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req</em>&nbsp;</td><td>The request being freed </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00223">223</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="295957efef868247c889aa3f5050af00"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_alloc_buffer" ref="295957efef868247c889aa3f5050af00" args="(struct usb_ep *usb_ep, unsigned bytes, dma_addr_t *dma, gfp_t gfp_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* dwc_otg_pcd_alloc_buffer           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dma_addr_t *&nbsp;</td>
          <td class="paramname"> <em>dma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfp_t&nbsp;</td>
          <td class="paramname"> <em>gfp_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function allocates an I/O buffer to be used for a transfer to/from the specified endpoint. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>usb_ep</em>&nbsp;</td><td>The endpoint to be used with with the request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bytes</em>&nbsp;</td><td>The desired number of bytes for the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dma</em>&nbsp;</td><td>Pointer to the buffer's DMA address; must be valid </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gfp_flags</em>&nbsp;</td><td>the GFP_* flags to use. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>address of a new buffer or null is buffer could not be allocated. </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00246">246</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="675a197388a82da27f74c11ffdbf874b"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_free_buffer" ref="675a197388a82da27f74c11ffdbf874b" args="(struct usb_ep *usb_ep, void *buf, dma_addr_t dma, unsigned bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dwc_otg_pcd_free_buffer           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dma_addr_t&nbsp;</td>
          <td class="paramname"> <em>dma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>bytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function frees an I/O buffer that was allocated by alloc_buffer. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>usb_ep</em>&nbsp;</td><td>the endpoint associated with the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>address of the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dma</em>&nbsp;</td><td>The buffer's DMA address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bytes</em>&nbsp;</td><td>The number of bytes of the buffer </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00282">282</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="f97bea831037135af73c3c202e3e01dc"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::ep_queue" ref="f97bea831037135af73c3c202e3e01dc" args="(struct usb_ep *usb_ep, struct usb_request *usb_req, gfp_t gfp_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ep_queue           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct usb_request *&nbsp;</td>
          <td class="paramname"> <em>usb_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfp_t&nbsp;</td>
          <td class="paramname"> <em>gfp_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is used to submit an I/O Request to an EP. 
<p>
<ul>
<li>When the request completes the request's completion callback is called to return the request to the driver.</li><li>An EP, except control EPs, may have multiple requests pending.</li><li>Once submitted the request cannot be examined or modified.</li><li>Each request is turned into one or more packets.</li><li>A BULK EP can queue any amount of data; the transfer is packetized.</li><li>Zero length Packets are specified with the request 'zero' flag. </li></ul>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00308">308</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="8ee99e0e68c8e50e94c242805b158cb2"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::ep_halt" ref="8ee99e0e68c8e50e94c242805b158cb2" args="(struct usb_ep *usb_ep, int value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ep_halt           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
usb_ep_set_halt stalls an endpoint. 
<p>
usb_ep_clear_halt clears an endpoint halt and resets its data toggle.<p>
Both of these functions are implemented with the same underlying function. The behavior depends on the value argument.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>usb_ep</em>&nbsp;</td><td>the Endpoint to halt or clear halt. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td><ul>
<li>0 means clear_halt.</li><li>1 means set_halt,</li><li>2 means clear stall lock flag.</li><li>3 means set stall lock flag. </li></ul>
</td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00391">391</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="eb3df484c8c344613a2a9b23e24036a8"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::iso_ep_start" ref="eb3df484c8c344613a2a9b23e24036a8" args="(struct usb_ep *usb_ep, struct usb_iso_request *req, gfp_t gfp_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int iso_ep_start           </td>
          <td>(</td>
          <td class="paramtype">struct usb_ep *&nbsp;</td>
          <td class="paramname"> <em>usb_ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct usb_iso_request *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfp_t&nbsp;</td>
          <td class="paramname"> <em>gfp_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is used to submit an ISOC Transfer Request to an EP. 
<p>
<ul>
<li>Every time a sync period completes the request's completion callback is called to provide data to the gadget driver.</li><li>Once submitted the request cannot be modified.</li><li>Each request is turned into periodic data packets untill ISO Transfer is stopped.. </li></ul>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00422">422</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="6a6034564b7cc6d8cebfbe02a944cd2c"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::wakeup" ref="6a6034564b7cc6d8cebfbe02a944cd2c" args="(struct usb_gadget *gadget)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int wakeup           </td>
          <td>(</td>
          <td class="paramtype">struct usb_gadget *&nbsp;</td>
          <td class="paramname"> <em>gadget</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initiates Session Request Protocol (SRP) to wakeup the host if no session is in progress. 
<p>
If a session is already in progress, but the device is suspended, remote wakeup signaling is started. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00603">603</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="647f81bc0edc9007af3ff2ba04e884f3"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::gadget_add_eps" ref="647f81bc0edc9007af3ff2ba04e884f3" args="(struct gadget_wrapper *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gadget_add_eps           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgadget__wrapper.html">gadget_wrapper</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function initialized the usb_ep structures to there default state. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>d</em>&nbsp;</td><td>Pointer on <a class="el" href="structgadget__wrapper.html">gadget_wrapper</a>. </td></tr>
  </table>
</dl>

<p>
Initialize the EP0 structure.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000045">Todo:</a></b></dt><dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd></dl>
<p>
Initialize the EP structures.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000045">Todo:</a></b></dt><dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000045">Todo:</a></b></dt><dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00824">824</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="6cbde69780790137d41fd45558236000"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_gadget_release" ref="6cbde69780790137d41fd45558236000" args="(struct device *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dwc_otg_pcd_gadget_release           </td>
          <td>(</td>
          <td class="paramtype">struct device *&nbsp;</td>
          <td class="paramname"> <em>dev</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function releases the Gadget device. 
<p>
required by device_unregister().<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000048">Todo:</a></b></dt><dd>Should this do something? Should it free the PCD? </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00937">937</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="8c1ba129028b3b16909973eb30b85d2c"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::usb_gadget_register_driver" ref="8c1ba129028b3b16909973eb30b85d2c" args="(struct usb_gadget_driver *driver)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int usb_gadget_register_driver           </td>
          <td>(</td>
          <td class="paramtype">struct usb_gadget_driver *&nbsp;</td>
          <td class="paramname"> <em>driver</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function registers a gadget driver with the PCD. 
<p>
When a driver is successfully registered, it will receive control requests including set_configuration(), which enables non-control requests. then usb traffic follows until a disconnect is reported. then a host may connect again, or the driver might get unbound.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>driver</em>&nbsp;</td><td>The driver being registered </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l01096">1096</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="fa4a24d0806fbb6e3135d27d24a6a00d"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::usb_gadget_unregister_driver" ref="fa4a24d0806fbb6e3135d27d24a6a00d" args="(struct usb_gadget_driver *driver)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int usb_gadget_unregister_driver           </td>
          <td>(</td>
          <td class="paramtype">struct usb_gadget_driver *&nbsp;</td>
          <td class="paramname"> <em>driver</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function unregisters a gadget driver. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>driver</em>&nbsp;</td><td>The driver being unregistered </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l01143">1143</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="8d23bf781df0ba0fb4a0133d08c09dc1"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_ep_ops" ref="8d23bf781df0ba0fb4a0133d08c09dc1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct usb_isoc_ep_ops <a class="el" href="dwc__otg__pcd__linux_8c.html#8d23bf781df0ba0fb4a0133d08c09dc1">dwc_otg_pcd_ep_ops</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .ep_ops = {
                   .enable = <a class="code" href="dwc__otg__pcd__linux_8c.html#9761890d7f741f9421d82254c9846f31">ep_enable</a>,
                   .disable = <a class="code" href="dwc__otg__pcd__linux_8c.html#1708514cb93c5da43a8f634de1c0f5e7">ep_disable</a>,

                   .alloc_request = <a class="code" href="dwc__otg__pcd__linux_8c.html#e5a3f75b9a06a4707d1d0ec5957daa7d">dwc_otg_pcd_alloc_request</a>,
                   .free_request = <a class="code" href="dwc__otg__pcd__linux_8c.html#348338816bfc0e711c4b875997ed00d9">dwc_otg_pcd_free_request</a>,

                   .alloc_buffer = <a class="code" href="dwc__otg__pcd__linux_8c.html#295957efef868247c889aa3f5050af00">dwc_otg_pcd_alloc_buffer</a>,
                   .free_buffer = <a class="code" href="dwc__otg__pcd__linux_8c.html#675a197388a82da27f74c11ffdbf874b">dwc_otg_pcd_free_buffer</a>,

                   .queue = <a class="code" href="dwc__otg__pcd__linux_8c.html#f97bea831037135af73c3c202e3e01dc">ep_queue</a>,
                   .dequeue = <a class="code" href="dwc__otg__pcd__linux_8c.html#e2e4913a926acc55f4e57c3ff8f97c08">ep_dequeue</a>,

                   .set_halt = <a class="code" href="dwc__otg__pcd__linux_8c.html#8ee99e0e68c8e50e94c242805b158cb2">ep_halt</a>,
                   .fifo_status = 0,
                   .fifo_flush = 0,
                   },
        .iso_ep_start = <a class="code" href="dwc__otg__pcd__linux_8c.html#eb3df484c8c344613a2a9b23e24036a8">iso_ep_start</a>,
        .iso_ep_stop = <a class="code" href="dwc__otg__pcd__linux_8c.html#cecdcaa060d30ac09414419545a5d1c6">iso_ep_stop</a>,
        .alloc_iso_request = <a class="code" href="dwc__otg__pcd__linux_8c.html#94fd50b5e9d41d1d38a503d819fc07c4">alloc_iso_request</a>,
        .free_iso_request = <a class="code" href="dwc__otg__pcd__linux_8c.html#a9a7bc869bc7f3d05804059f3277d11a">free_iso_request</a>,
}
</pre></div>
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00507">507</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="592a942ef237021f608d03dd8b57bc54"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::dwc_otg_pcd_ops" ref="592a942ef237021f608d03dd8b57bc54" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct usb_gadget_ops <a class="el" href="dwc__otg__pcd__linux_8c.html#592a942ef237021f608d03dd8b57bc54">dwc_otg_pcd_ops</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .get_frame = <a class="code" href="dwc__otg__hcd__linux_8c.html#c78128edb8902dc96534c5bb253f99a3">get_frame_number</a>,
        .wakeup = <a class="code" href="dwc__otg__pcd__linux_8c.html#6a6034564b7cc6d8cebfbe02a944cd2c">wakeup</a>,



        
}
</pre></div>
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00618">618</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<a class="anchor" name="9ce9b5e49c60906c189bee157dd68acd"></a><!-- doxytag: member="dwc_otg_pcd_linux.c::fops" ref="9ce9b5e49c60906c189bee157dd68acd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdwc__otg__pcd__function__ops.html">dwc_otg_pcd_function_ops</a> <a class="el" href="dwc__otg__pcd__linux_8c.html#9ce9b5e49c60906c189bee157dd68acd">fops</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .complete = <a class="code" href="dwc__otg__hcd__linux_8c.html#a0d18986574c384e98aa280e0475a9aa">_complete</a>,

        .isoc_complete = <a class="code" href="dwc__otg__pcd__linux_8c.html#737e47386e05da8cf6cbf85a289f5454">_isoc_complete</a>,

        .setup = <a class="code" href="dwc__otg__pcd__linux_8c.html#4a1481839b3d869d882f984a6c6ed9e5">_setup</a>,
        .disconnect = <a class="code" href="dwc__otg__hcd__linux_8c.html#8011f9b662a7f4182e762de616bbc95e">_disconnect</a>,
        .connect = <a class="code" href="dwc__otg__pcd__linux_8c.html#c7c1c4f8fe8e62f1d9e6f75de5563658">_connect</a>,
        .resume = <a class="code" href="dwc__otg__pcd__linux_8c.html#86cdfe71d125da339e17e52049fc5ea0">_resume</a>,
        .suspend = <a class="code" href="dwc__otg__pcd__linux_8c.html#7f479ecaee0801b55b4f0bd0f36f8b67">_suspend</a>,
        .hnp_changed = <a class="code" href="dwc__otg__pcd__linux_8c.html#9e8595e1d36e6b1ffbc27c4862957a08">_hnp_changed</a>,
        .reset = <a class="code" href="dwc__otg__pcd__linux_8c.html#208cf9e0227e5f81e015ed3ac5bacec4">_reset</a>,



}
</pre></div>
<p>
Definition at line <a class="el" href="dwc__otg__pcd__linux_8c-source.html#l00786">786</a> of file <a class="el" href="dwc__otg__pcd__linux_8c-source.html">dwc_otg_pcd_linux.c</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue May 5 02:22:49 2009 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
