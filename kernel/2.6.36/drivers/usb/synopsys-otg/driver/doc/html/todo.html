<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: Todo List</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1><a class="anchor" name="todo">Todo List</a></h1><a class="anchor" name="_todo000001"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__attr_8c.html#a6ede17e817a37b1207d7a82147a8e57">DWC_OTG_DEVICE_ATTR_BITFIELD_SHOW</a>  </dt>
<dd>Add code to initiate the HNP. </dd>
</dl>
<p>
<a class="anchor" name="_todo000002"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__attr_8c.html#9e8313bb6a0f54484d279b2e28269712">srp_show</a>  </dt>
<dd>Add code to initiate the SRP. </dd>
</dl>
<p>
<a class="anchor" name="_todo000003"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__attr_8c.html#6979f4909cde868d800dba13ef95aa8c">buspower_show</a>  </dt>
<dd>Need to do more for power on/off? </dd>
</dl>
<p>
<a class="anchor" name="_todo000004"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__attr_8c.html#ae1f7e3a17c5a0bcc5a93096aeb902d2">bussuspend_show</a>  </dt>
<dd>Need to do more for suspend? </dd>
</dl>
<p>
<a class="anchor" name="_todo000005"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#3d60e58f32be881047ac61bc852f60f7">dwc_otg_enable_device_interrupts</a>  </dt>
<dd>NGS: Should this be a module parameter? </dd>
</dl>
<p>
<a class="anchor" name="_todo000006"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#f79b0f3b5b96b0535e33627ee3a66eba">dwc_otg_core_dev_init</a>  </dt>
<dd>NGS: Fix Periodic FIFO Sizing! </dd>
</dl>
<p>
<a class="anchor" name="_todo000006"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#f79b0f3b5b96b0535e33627ee3a66eba">dwc_otg_core_dev_init</a>  </dt>
<dd>Finish debug of this </dd>
</dl>
<p>
<a class="anchor" name="_todo000006"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#f79b0f3b5b96b0535e33627ee3a66eba">dwc_otg_core_dev_init</a>  </dt>
<dd>- if the condition needed to be checked or in any case all pending interrutps should be cleared? </dd>
</dl>
<p>
<a class="anchor" name="_todo000009"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#d8c1e6f7860c482df84db003b52c369c">dwc_otg_ep0_continue_transfer</a>  </dt>
<dd>Should there be check for room in the Tx Status Queue. If not remove the code above this comment. </dd>
</dl>
<p>
<a class="anchor" name="_todo000010"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#97a11808b8b12a365a91f02b6d686d0c">dwc_otg_ep_write_packet</a>  </dt>
<dd>NGS Where are the Periodic Tx FIFO addresses intialized? What should this be? </dd>
</dl>
<p>
<a class="anchor" name="_todo000011"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil_8c.html#68f59dd23ccfffa9aa1dc590e99b7668">dwc_otg_read_packet</a>  </dt>
<dd>Account for the case where _dest is not dword aligned. This requires reading data from the FIFO into a uint32_t temp buffer, then moving it into the data buffer. </dd>
</dl>
<p>
<a class="anchor" name="_todo000012"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil__intr_8c.html#93001a1a9717b7e0491f5a2548fce1b6">dwc_otg_handle_disconnect_intr</a>  </dt>
<dd>Consolidate this if statement. </dd>
</dl>
<p>
<a class="anchor" name="_todo000013"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__cil__intr_8c.html#b86f8c4806bdc1f78ea438263c9f6c67">dwc_otg_read_common_intr</a>  </dt>
<dd>: The port interrupt occurs while in device mode. Added code to CIL to clear the interrupt for now! </dd>
</dl>
<p>
<a class="anchor" name="_todo000014"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__driver_8c.html#e0dbd8f1a438746fa8ec7798ceb2bd50">MODULE_PARM_DESC</a>  </dt>
<dd>Set the max to 512K, modify checks </dd>
</dl>
<p>
<a class="anchor" name="_todo000016"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd_8h.html#b9dde24773f2741b9ff67e2d46760dc0">dwc_otg_hcd_handle_intr</a>  </dt>
<dd>Implement i2cintr handler. </dd>
</dl>
<p>
<a class="anchor" name="_todo000020"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd_8h.html#187194b7a9f28e7f7a09ac3e345c7253">dwc_otg_hcd_qh_create</a>  </dt>
<dd>add memflags argument </dd>
</dl>
<p>
<a class="anchor" name="_todo000015"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd_8h.html#ca94cde3142ff1121bb0ff9bd44fa762">dwc_otg_hcd_complete_xfer_ddma</a>  </dt>
<dd>Consider the case when period exceeds FrameList size. Frame Rollover interrupt should be used. </dd>
</dl>
<p>
<a class="anchor" name="_todo000017"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd__intr_8c.html#5093a2b94c1d5cd1988eb93d9def298f">handle_hc_nyet_intr</a>  </dt>
<dd>add support for isoc release </dd>
</dl>
<p>
<a class="anchor" name="_todo000018"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd__intr_8c.html#d75ed153a90dbda39d4d8e6cde4358df">handle_hc_chhltd_intr_dma</a>  </dt>
<dd>This is here because of a possible hardware bug. Spec says that on SPLIT-ISOC OUT transfers in DMA mode that a HALT interrupt w/ACK bit set should occur, but I only see the XFERCOMP bit, even with it masked out. This is a workaround for that behavior. Should fix this when hardware is fixed. </dd>
</dl>
<p>
<a class="anchor" name="_todo000019"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__hcd__queue_8c.html#d32f8a4be67b758e9541e33746363677">qh_init</a>  </dt>
<dd>Account for split transfers in the bus time. </dd>
</dl>
<p>
<a class="anchor" name="_todo000021"></a> <dl>
<dt>File <a class="el" href="dwc__otg__pcd_8c.html">dwc_otg_pcd.c</a>  </dt>
<dd>Add Device Mode test modes (Test J mode, Test K mode, etc). <p>
Does it work when the request size is greater than DEPTSIZ transfer size<p>
</dd>
</dl>
<p>
<a class="anchor" name="_todo000022"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd_8c.html#e0a690ac031f8f06c2e7fb10b4633b05">dwc_otg_pcd_iso_ep_start</a>  </dt>
<dd>- pattern data support is to be implemented in the future </dd>
</dl>
<p>
<a class="anchor" name="_todo000023"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd_8c.html#b6506996bd4b93ef4f80092a64384fae">dwc_otg_pcd_reinit</a>  </dt>
<dd>NGS: Add direction to EP, based on contents of HWCFG1. Need a copy of HWCFG1 in pcd structure? sprintf(";r </dd>
</dl>
<p>
<a class="anchor" name="_todo000023"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd_8c.html#b6506996bd4b93ef4f80092a64384fae">dwc_otg_pcd_reinit</a>  </dt>
<dd>NGS: Add direction to EP, based on contents of HWCFG1. Need a copy of HWCFG1 in pcd structure? sprintf(";r </dd>
</dl>
<p>
<a class="anchor" name="_todo000025"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd_8c.html#09f3d77397aa7d22a1ca32e26c8aedea">dwc_otg_pcd_ep_queue</a>  </dt>
<dd>NGS Create a function for this. </dd>
</dl>
<p>
<a class="anchor" name="_todo000033"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd_8h.html#9d6d6e24faab6478aef9e2217c9b5ab9">do_test_mode</a>  </dt>
<dd>This has not been tested since the tasklet struct was put into the PCD struct!<p>
</dd>
</dl>
<p>
<a class="anchor" name="_todo000026"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#99560d3941c21dedd1fb1fc846cea24f">dwc_otg_pcd_handle_rx_status_q_level_intr</a>  </dt>
<dd>NGS Check for buffer overflow? </dd>
</dl>
<p>
<a class="anchor" name="_todo000027"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#fde237571d3aaa5d03376d3bee827075">get_ep_of_last_in_token</a>  </dt>
<dd>Find a simpler way to calculate the max queue position. </dd>
</dl>
<p>
<a class="anchor" name="_todo000028"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#19e17d6a73d8a3ebf00a1d11999a5ff9">dwc_otg_pcd_stop</a>  </dt>
<dd>NGS Flush Periodic FIFOs </dd>
</dl>
<p>
<a class="anchor" name="_todo000029"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#726b57833bb3ae4648ce7e7a7e125bf7">ep0_out_start</a>  </dt>
<dd>NGS: Update the comments from the HW FS.<p>
</dd>
</dl>
<p>
<a class="anchor" name="_todo000029"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#726b57833bb3ae4648ce7e7a7e125bf7">ep0_out_start</a>  </dt>
<dd>dma needs to handle multiple setup packets (up to 3) </dd>
</dl>
<p>
<a class="anchor" name="_todo000031"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#6c417c7d86bc9540e13ca4faeaf3dfbf">do_gadget_setup</a>  </dt>
<dd>This is a g_file_storage gadget driver specific workaround: a DELAYED_STATUS result from the fsg_setup routine will result in the gadget queueing a EP0 IN status phase for a two-stage control transfer. Exactly the same as a SET_CONFIGURATION/SET_INTERFACE except that this is a class specific request. Need a generic way to know when the gadget driver will queue the status phase. Can we assume when we call the gadget driver setup() function that it will always queue and require the following flag? Need to look into this. </dd>
</dl>
<p>
<a class="anchor" name="_todo000032"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#153d9a3b2162ef091dc24027379af19f">pcd_clear_halt</a>  </dt>
<dd>FIXME: this causes an EP mismatch in DMA mode. epmismatch not yet implemented. </dd>
</dl>
<p>
<a class="anchor" name="_todo000034"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#f449add2b4e8de7ced10fd1bb4c5b748">do_get_status</a>  </dt>
<dd>check for EP stall </dd>
</dl>
<p>
<a class="anchor" name="_todo000035"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#3754b29956ab3a85851dea376e046db9">do_set_feature</a>  </dt>
<dd>This has not been tested since the tasklet struct was put into the PCD struct! </dd>
</dl>
<p>
<a class="anchor" name="_todo000035"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#3754b29956ab3a85851dea376e046db9">do_set_feature</a>  </dt>
<dd>Is the gotgctl.devhnpen cleared by a USB Reset? </dd>
</dl>
<p>
<a class="anchor" name="_todo000037"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#2198ea3f0136465fa325a189d4ba5140">do_clear_feature</a>  </dt>
<dd>Add CLEAR_FEATURE for TEST modes. </dd>
</dl>
<p>
<a class="anchor" name="_todo000038"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#856a520a378e4f6f274253227080cfa1">pcd_setup</a>  </dt>
<dd>handle &gt; 1 setup packet , assert error for now </dd>
</dl>
<p>
<a class="anchor" name="_todo000038"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#856a520a378e4f6f274253227080cfa1">pcd_setup</a>  </dt>
<dd>NGS: Handle bad setup packet? </dd>
</dl>
<p>
<a class="anchor" name="_todo000040"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#65d4f747d13e368916ee0e16d202119b">handle_in_ep_timeout_intr</a>  </dt>
<dd>NGS Check EP type. Implement for Periodic EPs </dd>
</dl>
<p>
<a class="anchor" name="_todo000041"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#273ccc8e8cdb9e2075844f2f922b53bf">handle_in_ep_nak_intr</a>  </dt>
<dd>implement ISR </dd>
</dl>
<p>
<a class="anchor" name="_todo000042"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#42aef7ea134cccf7cdb53e7e1428bc4a">handle_out_ep_babble_intr</a>  </dt>
<dd>implement ISR </dd>
</dl>
<p>
<a class="anchor" name="_todo000043"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#252929e585c84eaf0485869cd7734244">handle_out_ep_nak_intr</a>  </dt>
<dd>implement ISR </dd>
</dl>
<p>
<a class="anchor" name="_todo000044"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__intr_8c.html#926d9068c1950cc406d50828e72a31db">handle_out_ep_nyet_intr</a>  </dt>
<dd>implement ISR </dd>
</dl>
<p>
<a class="anchor" name="_todo000045"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__linux_8c.html#647f81bc0edc9007af3ff2ba04e884f3">gadget_add_eps</a>  </dt>
<dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd>
</dl>
<p>
<a class="anchor" name="_todo000045"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__linux_8c.html#647f81bc0edc9007af3ff2ba04e884f3">gadget_add_eps</a>  </dt>
<dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd>
</dl>
<p>
<a class="anchor" name="_todo000045"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__linux_8c.html#647f81bc0edc9007af3ff2ba04e884f3">gadget_add_eps</a>  </dt>
<dd>NGS: What should the max packet size be set to here? Before EP type is set? </dd>
</dl>
<p>
<a class="anchor" name="_todo000048"></a> <dl>
<dt>Global <a class="el" href="dwc__otg__pcd__linux_8c.html#6cbde69780790137d41fd45558236000">dwc_otg_pcd_gadget_release</a>  </dt>
<dd>Should this do something? Should it free the PCD? </dd>
</dl>
<hr size="1"><address style="align: right;"><small>Generated on Tue May 5 02:22:49 2009 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
