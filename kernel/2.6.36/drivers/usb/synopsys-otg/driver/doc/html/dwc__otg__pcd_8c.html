<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: dwc_otg_pcd.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>dwc_otg_pcd.c File Reference</h1>This file implements PCD Core. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="dwc__otg__pcd_8h-source.html">dwc_otg_pcd.h</a>&quot;</code><br>

<p>
<a href="dwc__otg__pcd_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4b46c226fa34cd7fc4ceec2c5e7f8ebe"></a><!-- doxytag: member="dwc_otg_pcd.c::get_ep_from_handle" ref="4b46c226fa34cd7fc4ceec2c5e7f8ebe" args="(dwc_otg_pcd_t *pcd, void *handle)" -->
static <a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#4b46c226fa34cd7fc4ceec2c5e7f8ebe">get_ep_from_handle</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *handle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#5c9b20abc81e0f860a8f23c90b10b59e">dwc_otg_request_done</a> (<a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *ep, <a class="el" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request_t</a> *req, int32_t status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function completes a request.  <a href="#5c9b20abc81e0f860a8f23c90b10b59e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e8ef6f3d831b89a753d93489827949d3"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_request_nuke" ref="e8ef6f3d831b89a753d93489827949d3" args="(dwc_otg_pcd_ep_t *ep)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#e8ef6f3d831b89a753d93489827949d3">dwc_otg_request_nuke</a> (<a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function terminates all the requsts in the EP request queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#187209231d66bc200444c0d52331d276">dwc_otg_pcd_start</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, const struct <a class="el" href="structdwc__otg__pcd__function__ops.html">dwc_otg_pcd_function_ops</a> *<a class="el" href="dwc__otg__pcd__linux_8c.html#9ce9b5e49c60906c189bee157dd68acd">fops</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Call this to bind the function driver to the PCD Core.  <a href="#187209231d66bc200444c0d52331d276"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#81693a91f25fb36b1443d3e597f9e59d">dwc_otg_pcd_start_cb</a> (void *p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PCD Callback function for initializing the PCD when switching to device mode.  <a href="#81693a91f25fb36b1443d3e597f9e59d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3951259aaef3df35d1955076a907f095"></a><!-- doxytag: member="dwc_otg_pcd.c::cfiw_ep_alloc_buffer" ref="3951259aaef3df35d1955076a907f095" args="(dwc_otg_pcd_t *pcd, void *pep, dwc_dma_t *addr, size_t buflen, int flags)" -->
uint8_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#3951259aaef3df35d1955076a907f095">cfiw_ep_alloc_buffer</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *pep, dwc_dma_t *addr, size_t buflen, int flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CFI-specific buffer allocation function for EP. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#7bc757d00f936e5e308e950a17281675">dwc_otg_pcd_resume_cb</a> (void *p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PCD Callback function for notifying the PCD when resuming from suspend.  <a href="#7bc757d00f936e5e308e950a17281675"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#41a824bd34aa279d07ba3a17da35cf11">dwc_otg_pcd_suspend_cb</a> (void *p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PCD Callback function for notifying the PCD device is suspended.  <a href="#41a824bd34aa279d07ba3a17da35cf11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#00e06d719bfc4fa4c40c8a06a88eb052">dwc_otg_pcd_stop_cb</a> (void *p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PCD Callback function for stopping the PCD when switching to Host mode.  <a href="#00e06d719bfc4fa4c40c8a06a88eb052"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="18b4a856523673f3bf97b676c8d9717e"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_ep_alloc_desc_chain" ref="18b4a856523673f3bf97b676c8d9717e" args="(uint32_t *dma_desc_addr, uint32_t count)" -->
<a class="el" href="structdwc__otg__dev__dma__desc.html">dwc_otg_dev_dma_desc_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#18b4a856523673f3bf97b676c8d9717e">dwc_otg_ep_alloc_desc_chain</a> (uint32_t *dma_desc_addr, uint32_t count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function allocates a DMA Descriptor chain for the Endpoint buffer to be used for a transfer to/from the specified endpoint. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1926b61a7438bd9a14bd6d6a26c6a63d"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_ep_free_desc_chain" ref="1926b61a7438bd9a14bd6d6a26c6a63d" args="(dwc_otg_dev_dma_desc_t *desc_addr, uint32_t dma_desc_addr, uint32_t count)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#1926b61a7438bd9a14bd6d6a26c6a63d">dwc_otg_ep_free_desc_chain</a> (<a class="el" href="structdwc__otg__dev__dma__desc.html">dwc_otg_dev_dma_desc_t</a> *desc_addr, uint32_t dma_desc_addr, uint32_t count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function frees a DMA Descriptor chain that was allocated by ep_alloc_desc. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#456f7e798e18c0b169fc196fb305e2ea">dwc_otg_iso_ep_start_ddma_transfer</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, <a class="el" href="structdwc__ep.html">dwc_ep_t</a> *<a class="el" href="structdwc__ep.html">dwc_ep</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function initializes a descriptor chain for Isochronous transfer.  <a href="#456f7e798e18c0b169fc196fb305e2ea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#0b13a31a7ddc82b53862cd06cfed6393">dwc_otg_iso_ep_start_buf_transfer</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, <a class="el" href="structdwc__ep.html">dwc_ep_t</a> *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function initializes a descriptor chain for Isochronous transfer.  <a href="#0b13a31a7ddc82b53862cd06cfed6393"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#3f39ccc23c6f9bd4fd4ab7a5cecc67a3">dwc_otg_iso_ep_start_transfer</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, <a class="el" href="structdwc__ep.html">dwc_ep_t</a> *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function does the setup for a data transfer for an EP and starts the transfer.  <a href="#3f39ccc23c6f9bd4fd4ab7a5cecc67a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#2898810e04a9dd19798f59cfdb56c670">dwc_otg_iso_ep_stop_transfer</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, <a class="el" href="structdwc__ep.html">dwc_ep_t</a> *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function does the setup for a data transfer for an EP and starts the transfer.  <a href="#2898810e04a9dd19798f59cfdb56c670"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#e0a690ac031f8f06c2e7fb10b4633b05">dwc_otg_pcd_iso_ep_start</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, uint8_t *buf0, uint8_t *buf1, dwc_dma_t dma0, dwc_dma_t dma1, int sync_frame, int dp_frame, int data_per_frame, int start_frame, int buf_proc_intrvl, void *req_handle, int atomic_alloc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start isochronous transfers on the endpoint referenced by ep_handle.  <a href="#e0a690ac031f8f06c2e7fb10b4633b05"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#5098f89da28c6b450e7e10b31441b945">dwc_otg_pcd_iso_ep_stop</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *req_handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop ISOC transfers on endpoint referenced by ep_handle.  <a href="#5098f89da28c6b450e7e10b31441b945"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#b4e2c352426923d4bd519cf18b68206d">dwc_otg_iso_buffer_done</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, <a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *ep, void *req_handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is used for perodical data exchnage between PCD and gadget drivers.  <a href="#b4e2c352426923d4bd519cf18b68206d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#2f04b14612c2b58909b3a54ed71ab12e">dwc_otg_pcd_get_iso_packet_count</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *iso_req_handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get ISOC packet count.  <a href="#2f04b14612c2b58909b3a54ed71ab12e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#21149047aa9abddac5654e4496175ac5">dwc_otg_pcd_get_iso_packet_params</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *iso_req_handle, int packet, int *status, int *actual, int *offset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get ISOC packet status.  <a href="#21149047aa9abddac5654e4496175ac5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dbfe9af71d4c36cbf7eb544a1df9364e"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_init_ep" ref="dbfe9af71d4c36cbf7eb544a1df9364e" args="(dwc_otg_pcd_t *pcd, dwc_otg_pcd_ep_t *pcd_ep, uint32_t is_in, uint32_t ep_num)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#dbfe9af71d4c36cbf7eb544a1df9364e">dwc_otg_pcd_init_ep</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, <a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *pcd_ep, uint32_t is_in, uint32_t ep_num)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#b6506996bd4b93ef4f80092a64384fae">dwc_otg_pcd_reinit</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise ep's.  <a href="#b6506996bd4b93ef4f80092a64384fae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#e1e5a9264c2ad212d697d6be1110874f">srp_timeout</a> (void *ptr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when the SRP timer expires.  <a href="#e1e5a9264c2ad212d697d6be1110874f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="de7160b7e7b8fd622ba95392513e197c"></a><!-- doxytag: member="dwc_otg_pcd.c::start_next_request" ref="de7160b7e7b8fd622ba95392513e197c" args="(dwc_otg_pcd_ep_t *ep)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#de7160b7e7b8fd622ba95392513e197c">start_next_request</a> (<a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tasklet. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4d9d8f7fb8f74eb64176fba91b38cb35"></a><!-- doxytag: member="dwc_otg_pcd.c::start_xfer_tasklet_func" ref="4d9d8f7fb8f74eb64176fba91b38cb35" args="(void *data)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#4d9d8f7fb8f74eb64176fba91b38cb35">start_xfer_tasklet_func</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#fc3d8c56afa93b474180cc1eb8624ab8">dwc_otg_pcd_init</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Call this function to get pointer on dwc_otg_pcd_t, this pointer will be used for all PCD API functions.  <a href="#fc3d8c56afa93b474180cc1eb8624ab8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#aaab1535dacd5e947c1f9343d9b3ddf5">dwc_otg_pcd_remove</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees PCD allocated by dwc_otg_pcd_init.  <a href="#aaab1535dacd5e947c1f9343d9b3ddf5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ae9b15825812485a06be318858e0316a"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_is_dualspeed" ref="ae9b15825812485a06be318858e0316a" args="(dwc_otg_pcd_t *pcd)" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#ae9b15825812485a06be318858e0316a">dwc_otg_pcd_is_dualspeed</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function returns whether device is dualspeed. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="07169d2569c7e071fc99045fd435f2c6"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_is_otg" ref="07169d2569c7e071fc99045fd435f2c6" args="(dwc_otg_pcd_t *pcd)" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#07169d2569c7e071fc99045fd435f2c6">dwc_otg_pcd_is_otg</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function returns whether device is otg. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5b3f2d055af51e556be50f3ada673e4a"></a><!-- doxytag: member="dwc_otg_pcd.c::assign_tx_fifo" ref="5b3f2d055af51e556be50f3ada673e4a" args="(dwc_otg_core_if_t *core_if)" -->
static uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#5b3f2d055af51e556be50f3ada673e4a">assign_tx_fifo</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function assigns periodic Tx FIFO to an periodic EP in shared Tx FIFO mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1df421d3a1449ec3a927d0a006c57c38"></a><!-- doxytag: member="dwc_otg_pcd.c::assign_perio_tx_fifo" ref="1df421d3a1449ec3a927d0a006c57c38" args="(dwc_otg_core_if_t *core_if)" -->
static uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#1df421d3a1449ec3a927d0a006c57c38">assign_perio_tx_fifo</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function assigns periodic Tx FIFO to an periodic EP in shared Tx FIFO mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1bd1933ef625beee77eb026c4b1acb15"></a><!-- doxytag: member="dwc_otg_pcd.c::release_perio_tx_fifo" ref="1bd1933ef625beee77eb026c4b1acb15" args="(dwc_otg_core_if_t *core_if, uint32_t fifo_num)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#1bd1933ef625beee77eb026c4b1acb15">release_perio_tx_fifo</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, uint32_t fifo_num)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function releases periodic Tx FIFO in shared Tx FIFO mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bde782d98282535dc0c29a468da11f02"></a><!-- doxytag: member="dwc_otg_pcd.c::release_tx_fifo" ref="bde782d98282535dc0c29a468da11f02" args="(dwc_otg_core_if_t *core_if, uint32_t fifo_num)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#bde782d98282535dc0c29a468da11f02">release_tx_fifo</a> (<a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if, uint32_t fifo_num)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function releases periodic Tx FIFO in shared Tx FIFO mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#b9168f11717bdc672d9a29226779e523">dwc_otg_pcd_ep_enable</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, const uint8_t *ep_desc, void *usb_ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables an endpoint for use.  <a href="#b9168f11717bdc672d9a29226779e523"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#8a2f791c79320c8c4657715a672822a4">dwc_otg_pcd_ep_disable</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable the endpoint referenced by ep_handle.  <a href="#8a2f791c79320c8c4657715a672822a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#09f3d77397aa7d22a1ca32e26c8aedea">dwc_otg_pcd_ep_queue</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, uint8_t *buf, dwc_dma_t dma_buf, uint32_t buflen, int zero, void *req_handle, int atomic_alloc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue a data transfer request on the endpoint referenced by ep_handle.  <a href="#09f3d77397aa7d22a1ca32e26c8aedea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#aa7546ce68d6fda67bb4cda0f69eedf3">dwc_otg_pcd_ep_dequeue</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, void *req_handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">De-queue the specified data transfer that has not yet completed.  <a href="#aa7546ce68d6fda67bb4cda0f69eedf3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#f7d01b4772f08c6a08f4a22300a7b43b">dwc_otg_pcd_ep_halt</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, void *ep_handle, int value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Halt (STALL) an endpoint or clear it.  <a href="#f7d01b4772f08c6a08f4a22300a7b43b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89fb8b7a8276390becc3370903af55e2"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_rem_wkup_from_suspend" ref="89fb8b7a8276390becc3370903af55e2" args="(dwc_otg_pcd_t *pcd, int set)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#89fb8b7a8276390becc3370903af55e2">dwc_otg_pcd_rem_wkup_from_suspend</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, int set)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function initiates remote wakeup of the host from suspend state. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="24cbdd57c573d864a09a30ae3ecda89a"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_remote_wakeup" ref="24cbdd57c573d864a09a30ae3ecda89a" args="(dwc_otg_pcd_t *pcd, int set)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#24cbdd57c573d864a09a30ae3ecda89a">dwc_otg_pcd_remote_wakeup</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd, int set)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Starts remote wakeup signaling. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#7e0d7b09dc6528626f4643deb296d68d">dwc_otg_pcd_wakeup</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function starts the SRP Protocol if no session is in progress.  <a href="#7e0d7b09dc6528626f4643deb296d68d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#517f9cf3e74ebb0b9e00ea1defc56697">dwc_otg_pcd_start_srp_timer</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start the SRP timer to detect when the SRP does not complete within 6 seconds.  <a href="#517f9cf3e74ebb0b9e00ea1defc56697"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4be3e59162a42a79705e3ea8dc5008fa"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_initiate_srp" ref="4be3e59162a42a79705e3ea8dc5008fa" args="(dwc_otg_pcd_t *pcd)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#4be3e59162a42a79705e3ea8dc5008fa">dwc_otg_pcd_initiate_srp</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate SRP. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="04876b716043a853b379d72ff3a215e5"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_get_frame_number" ref="04876b716043a853b379d72ff3a215e5" args="(dwc_otg_pcd_t *pcd)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#04876b716043a853b379d72ff3a215e5">dwc_otg_pcd_get_frame_number</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function returns current frame number. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="676021c9b801674669cdf2d1e68d5b8c"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_is_lpm_enabled" ref="676021c9b801674669cdf2d1e68d5b8c" args="(dwc_otg_pcd_t *pcd)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#676021c9b801674669cdf2d1e68d5b8c">dwc_otg_pcd_is_lpm_enabled</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function returns 1 if LPM support is enabled, and 0 otherwise. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="777a6a4e250add9ba5f5f5d63d854031"></a><!-- doxytag: member="dwc_otg_pcd.c::get_b_hnp_enable" ref="777a6a4e250add9ba5f5f5d63d854031" args="(dwc_otg_pcd_t *pcd)" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#777a6a4e250add9ba5f5f5d63d854031">get_b_hnp_enable</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">These functions allow to get hnp parameters. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="69d0bb469e15cb46f00c17398f76df99"></a><!-- doxytag: member="dwc_otg_pcd.c::get_a_hnp_support" ref="69d0bb469e15cb46f00c17398f76df99" args="(dwc_otg_pcd_t *pcd)" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#69d0bb469e15cb46f00c17398f76df99">get_a_hnp_support</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="842709a4980bc78d49726fa880922dda"></a><!-- doxytag: member="dwc_otg_pcd.c::get_a_alt_hnp_support" ref="842709a4980bc78d49726fa880922dda" args="(dwc_otg_pcd_t *pcd)" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#842709a4980bc78d49726fa880922dda">get_a_alt_hnp_support</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0107dd39d549d3e10fd388337e03aeb9"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_get_rmwkup_enable" ref="0107dd39d549d3e10fd388337e03aeb9" args="(dwc_otg_pcd_t *pcd)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#0107dd39d549d3e10fd388337e03aeb9">dwc_otg_pcd_get_rmwkup_enable</a> (<a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *pcd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function returns 1 if remote wakeup is allowed and 0, otherwise. <br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="structdwc__otg__cil__callbacks.html">dwc_otg_cil_callbacks_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__pcd_8c.html#c360aaa36ba28b977284fd482e7bc5ca">pcd_callbacks</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PCD Callback structure for handling mode switching.  <a href="#c360aaa36ba28b977284fd482e7bc5ca"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This file implements PCD Core. 
<p>
All code in this file is portable and don't use any OS specific functions. PCD Core provides Interface, defined in <code>&lt;<a class="el" href="dwc__otg__pcd__if_8h.html">dwc_otg_pcd_if.h</a>&gt;</code> header file, which can be used to implement OS specific PCD interface.<p>
An important function of the PCD is managing interrupts generated by the DWC_otg controller. The implementation of the DWC_otg device mode interrupt service routines is in <a class="el" href="dwc__otg__pcd__intr_8c.html">dwc_otg_pcd_intr.c</a>.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>Add Device Mode test modes (Test J mode, Test K mode, etc). <p>
Does it work when the request size is greater than DEPTSIZ transfer size</dd></dl>

<p>
Definition in file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="5c9b20abc81e0f860a8f23c90b10b59e"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_request_done" ref="5c9b20abc81e0f860a8f23c90b10b59e" args="(dwc_otg_pcd_ep_t *ep, dwc_otg_pcd_request_t *req, int32_t status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_request_done           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request_t</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>status</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function completes a request. 
<p>
It call's the request call back. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00078">78</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="187209231d66bc200444c0d52331d276"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_start" ref="187209231d66bc200444c0d52331d276" args="(dwc_otg_pcd_t *pcd, const struct dwc_otg_pcd_function_ops *fops)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_pcd_start           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdwc__otg__pcd__function__ops.html">dwc_otg_pcd_function_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>fops</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call this to bind the function driver to the PCD Core. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>Pointer on dwc_otg_pcd_t returned by dwc_otg_pcd_init function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fops</em>&nbsp;</td><td>The Function Driver Ops data structure containing pointers to all callbacks. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00117">117</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="81693a91f25fb36b1443d3e597f9e59d"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_start_cb" ref="81693a91f25fb36b1443d3e597f9e59d" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t dwc_otg_pcd_start_cb           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PCD Callback function for initializing the PCD when switching to device mode. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>void pointer to the <code>dwc_otg_pcd_t</code> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00129">129</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="7bc757d00f936e5e308e950a17281675"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_resume_cb" ref="7bc757d00f936e5e308e950a17281675" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t dwc_otg_pcd_resume_cb           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PCD Callback function for notifying the PCD when resuming from suspend. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>void pointer to the <code>dwc_otg_pcd_t</code> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00163">163</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="41a824bd34aa279d07ba3a17da35cf11"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_suspend_cb" ref="41a824bd34aa279d07ba3a17da35cf11" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t dwc_otg_pcd_suspend_cb           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PCD Callback function for notifying the PCD device is suspended. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>void pointer to the <code>dwc_otg_pcd_t</code> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00187">187</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="00e06d719bfc4fa4c40c8a06a88eb052"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_stop_cb" ref="00e06d719bfc4fa4c40c8a06a88eb052" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t dwc_otg_pcd_stop_cb           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PCD Callback function for stopping the PCD when switching to Host mode. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>void pointer to the <code>dwc_otg_pcd_t</code> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00204">204</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="456f7e798e18c0b169fc196fb305e2ea"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_iso_ep_start_ddma_transfer" ref="456f7e798e18c0b169fc196fb305e2ea" args="(dwc_otg_core_if_t *core_if, dwc_ep_t *dwc_ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_iso_ep_start_ddma_transfer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *&nbsp;</td>
          <td class="paramname"> <em>core_if</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__ep.html">dwc_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>dwc_ep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function initializes a descriptor chain for Isochronous transfer. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>core_if</em>&nbsp;</td><td>Programming view of DWC_otg controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structdwc__ep.html">dwc_ep</a></em>&nbsp;</td><td>The EP to start the transfer on. </td></tr>
  </table>
</dl>

<p>
Allocate descriptors for double buffering<p>
ISO OUT EP<p>
Buffer 0 descriptors setup<p>
Buffer 1 descriptors setup<p>
Write dma_ad into DOEPDMA register<p>
ISO IN EP<p>
Buffer 0 descriptors setup<p>
Buffer 1 descriptors setup<p>
Write dma_ad into diepdma register<p>
Enable endpoint, clear nak 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00254">254</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="0b13a31a7ddc82b53862cd06cfed6393"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_iso_ep_start_buf_transfer" ref="0b13a31a7ddc82b53862cd06cfed6393" args="(dwc_otg_core_if_t *core_if, dwc_ep_t *ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_iso_ep_start_buf_transfer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *&nbsp;</td>
          <td class="paramname"> <em>core_if</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__ep.html">dwc_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function initializes a descriptor chain for Isochronous transfer. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>core_if</em>&nbsp;</td><td>Programming view of DWC_otg controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep</em>&nbsp;</td><td>The EP to start the transfer on. </td></tr>
  </table>
</dl>

<p>
Enable endpoint, clear nak 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00517">517</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="3f39ccc23c6f9bd4fd4ab7a5cecc67a3"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_iso_ep_start_transfer" ref="3f39ccc23c6f9bd4fd4ab7a5cecc67a3" args="(dwc_otg_core_if_t *core_if, dwc_ep_t *ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dwc_otg_iso_ep_start_transfer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *&nbsp;</td>
          <td class="paramname"> <em>core_if</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__ep.html">dwc_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function does the setup for a data transfer for an EP and starts the transfer. 
<p>
For an IN transfer, the packets will be loaded into the appropriate Tx FIFO in the ISR. For OUT transfers, the packets are unloaded from the Rx FIFO in the ISR. the ISR.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>core_if</em>&nbsp;</td><td>Programming view of DWC_otg controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep</em>&nbsp;</td><td>The EP to start the transfer on. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00598">598</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="2898810e04a9dd19798f59cfdb56c670"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_iso_ep_stop_transfer" ref="2898810e04a9dd19798f59cfdb56c670" args="(dwc_otg_core_if_t *core_if, dwc_ep_t *ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_iso_ep_stop_transfer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *&nbsp;</td>
          <td class="paramname"> <em>core_if</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__ep.html">dwc_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function does the setup for a data transfer for an EP and starts the transfer. 
<p>
For an IN transfer, the packets will be loaded into the appropriate Tx FIFO in the ISR. For OUT transfers, the packets are unloaded from the Rx FIFO in the ISR. the ISR.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>core_if</em>&nbsp;</td><td>Programming view of DWC_otg controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep</em>&nbsp;</td><td>The EP to start the transfer on. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00641">641</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="e0a690ac031f8f06c2e7fb10b4633b05"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_iso_ep_start" ref="e0a690ac031f8f06c2e7fb10b4633b05" args="(dwc_otg_pcd_t *pcd, void *ep_handle, uint8_t *buf0, uint8_t *buf1, dwc_dma_t dma0, dwc_dma_t dma1, int sync_frame, int dp_frame, int data_per_frame, int start_frame, int buf_proc_intrvl, void *req_handle, int atomic_alloc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_iso_ep_start           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>buf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>buf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dwc_dma_t&nbsp;</td>
          <td class="paramname"> <em>dma0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dwc_dma_t&nbsp;</td>
          <td class="paramname"> <em>dma1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sync_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dp_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>data_per_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>start_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buf_proc_intrvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>atomic_alloc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start isochronous transfers on the endpoint referenced by ep_handle. 
<p>
For isochronous transfers duble buffering is used. After processing each of buffers comlete callback will be called with status for each transaction.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>The handle of the endpoint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf0</em>&nbsp;</td><td>The virtual address of first data buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf1</em>&nbsp;</td><td>The virtual address of second data buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dma0</em>&nbsp;</td><td>The DMA address of first data buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dma1</em>&nbsp;</td><td>The DMA address of second data buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sync_frame</em>&nbsp;</td><td>Data pattern frame number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dp_frame</em>&nbsp;</td><td>Data size for pattern frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data_per_frame</em>&nbsp;</td><td>Data size for regular frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>start_frame</em>&nbsp;</td><td>Frame number to start transfers, if -1 then start transfers ASAP. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf_proc_intrvl</em>&nbsp;</td><td>Interval of ISOC Buffer processing </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_handle</em>&nbsp;</td><td>Handle of ISOC request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atomic_alloc</em>&nbsp;</td><td>Specefies whether to perform atomic allocation for internal data structures.</td></tr>
  </table>
</dl>
Returns -DWC_E_NO_MEMORY if there is no enough memory. Returns -DWC_E_INVALID if incorrect arguments are passed to the function. Returns -DW_E_SHUTDOWN for any other error. Returns 0 on success 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd><ul>
<li>pattern data support is to be implemented in the future </li></ul>
</dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00685">685</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="5098f89da28c6b450e7e10b31441b945"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_iso_ep_stop" ref="5098f89da28c6b450e7e10b31441b945" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *req_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_iso_ep_stop           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stop ISOC transfers on endpoint referenced by ep_handle. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>The handle of the endpoint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_handle</em>&nbsp;</td><td>Handle of ISOC request</td></tr>
  </table>
</dl>
Returns -DWC_E_INVALID if incorrect arguments are passed to the function Returns 0 on success 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00794">794</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="b4e2c352426923d4bd519cf18b68206d"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_iso_buffer_done" ref="b4e2c352426923d4bd519cf18b68206d" args="(dwc_otg_pcd_t *pcd, dwc_otg_pcd_ep_t *ep, void *req_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_iso_buffer_done           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is used for perodical data exchnage between PCD and gadget drivers. 
<p>
for Isochronous EPs<p>
<ul>
<li>Every time a sync period completes this function is called to perform data exchange between PCD and gadget </li></ul>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00830">830</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="2f04b14612c2b58909b3a54ed71ab12e"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_get_iso_packet_count" ref="2f04b14612c2b58909b3a54ed71ab12e" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *iso_req_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_get_iso_packet_count           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>iso_req_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get ISOC packet count. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>The handle of the endpoint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iso_req_handle</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00850">850</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="21149047aa9abddac5654e4496175ac5"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_get_iso_packet_params" ref="21149047aa9abddac5654e4496175ac5" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *iso_req_handle, int packet, int *status, int *actual, int *offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_pcd_get_iso_packet_params           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>iso_req_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>actual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>offset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get ISOC packet status. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>The handle of the endpoint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iso_req_handle</em>&nbsp;</td><td>Isochronoush request handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>packet</em>&nbsp;</td><td>Number of packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>Out parameter for returning status </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>actual</em>&nbsp;</td><td>Out parameter for returning actual length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>Out parameter for returning offset </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00862">862</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="b6506996bd4b93ef4f80092a64384fae"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_reinit" ref="b6506996bd4b93ef4f80092a64384fae" args="(dwc_otg_pcd_t *pcd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dwc_otg_pcd_reinit           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialise ep's. 
<p>

<p>
Initialize the EP0 structure.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>NGS: Add direction to EP, based on contents of HWCFG1. Need a copy of HWCFG1 in pcd structure? sprintf(";r </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>NGS: Add direction to EP, based on contents of HWCFG1. Need a copy of HWCFG1 in pcd structure? sprintf(";r </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00911">911</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="e1e5a9264c2ad212d697d6be1110874f"></a><!-- doxytag: member="dwc_otg_pcd.c::srp_timeout" ref="e1e5a9264c2ad212d697d6be1110874f" args="(void *ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void srp_timeout           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ptr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when the SRP timer expires. 
<p>
The SRP should complete within 6 seconds. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00970">970</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="fc3d8c56afa93b474180cc1eb8624ab8"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_init" ref="fc3d8c56afa93b474180cc1eb8624ab8" args="(dwc_otg_core_if_t *core_if)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a>* dwc_otg_pcd_init           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *&nbsp;</td>
          <td class="paramname"> <em>core_if</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call this function to get pointer on dwc_otg_pcd_t, this pointer will be used for all PCD API functions. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>core_if</em>&nbsp;</td><td>The DWC_OTG Core </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01056">1056</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="aaab1535dacd5e947c1f9343d9b3ddf5"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_remove" ref="aaab1535dacd5e947c1f9343d9b3ddf5" args="(dwc_otg_pcd_t *pcd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_pcd_remove           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Frees PCD allocated by dwc_otg_pcd_init. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01215">1215</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="b9168f11717bdc672d9a29226779e523"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_ep_enable" ref="b9168f11717bdc672d9a29226779e523" args="(dwc_otg_pcd_t *pcd, const uint8_t *ep_desc, void *usb_ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_ep_enable           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>ep_desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables an endpoint for use. 
<p>
This function enables an endpoint in the PCD. The endpoint is described by the ep_desc which has the same format as a USB ep descriptor. The ep_handle parameter is used to refer to the endpoint from other API functions and in callbacks. Normally this should be called after a SET_CONFIGURATION/SET_INTERFACE to configure the core for that interface.<p>
Returns -DWC_E_INVALID if invalid parameters were passed. Returns -DWC_E_SHUTDOWN if any other error ocurred. Returns 0 on success.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_desc</em>&nbsp;</td><td>Endpoint descriptor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>Handle on endpoint, that will be used to identify endpoint. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01341">1341</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="8a2f791c79320c8c4657715a672822a4"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_ep_disable" ref="8a2f791c79320c8c4657715a672822a4" args="(dwc_otg_pcd_t *pcd, void *ep_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_ep_disable           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disable the endpoint referenced by ep_handle. 
<p>
Returns -DWC_E_INVALID if invalid parameters were passed. Returns -DWC_E_SHUTDOWN if any other error ocurred. Returns 0 on success. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01449">1449</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="09f3d77397aa7d22a1ca32e26c8aedea"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_ep_queue" ref="09f3d77397aa7d22a1ca32e26c8aedea" args="(dwc_otg_pcd_t *pcd, void *ep_handle, uint8_t *buf, dwc_dma_t dma_buf, uint32_t buflen, int zero, void *req_handle, int atomic_alloc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_ep_queue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dwc_dma_t&nbsp;</td>
          <td class="paramname"> <em>dma_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>zero</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>atomic_alloc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Queue a data transfer request on the endpoint referenced by ep_handle. 
<p>
After the transfer is completes, the complete callback will be called with the request status.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>The PCD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ep_handle</em>&nbsp;</td><td>The handle of the endpoint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The buffer for the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dma_buf</em>&nbsp;</td><td>The DMA buffer for the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buflen</em>&nbsp;</td><td>The length of the data transfer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zero</em>&nbsp;</td><td>Specifies whether to send zero length last packet. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_handle</em>&nbsp;</td><td>Set this handle to any value to use to reference this request in the ep_dequeue function or from the complete callback </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atomic_alloc</em>&nbsp;</td><td>If driver need to perform atomic allocations for internal data structures.</td></tr>
  </table>
</dl>
Returns -DWC_E_INVALID if invalid parameters were passed. Returns -DWC_E_SHUTDOWN if any other error ocurred. Returns 0 on success. 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>NGS Create a function for this. </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01502">1502</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="aa7546ce68d6fda67bb4cda0f69eedf3"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_ep_dequeue" ref="aa7546ce68d6fda67bb4cda0f69eedf3" args="(dwc_otg_pcd_t *pcd, void *ep_handle, void *req_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_ep_dequeue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
De-queue the specified data transfer that has not yet completed. 
<p>
Returns -DWC_E_INVALID if invalid parameters were passed. Returns -DWC_E_SHUTDOWN if any other error ocurred. Returns 0 on success. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01694">1694</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="f7d01b4772f08c6a08f4a22300a7b43b"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_ep_halt" ref="f7d01b4772f08c6a08f4a22300a7b43b" args="(dwc_otg_pcd_t *pcd, void *ep_handle, int value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_ep_halt           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ep_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Halt (STALL) an endpoint or clear it. 
<p>
Returns -DWC_E_INVALID if invalid parameters were passed. Returns -DWC_E_SHUTDOWN if any other error ocurred. Returns -DWC_E_AGAIN if the STALL cannot be sent and must be tried again later Returns 0 on success. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01733">1733</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="7e0d7b09dc6528626f4643deb296d68d"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_wakeup" ref="7e0d7b09dc6528626f4643deb296d68d" args="(dwc_otg_pcd_t *pcd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dwc_otg_pcd_wakeup           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function starts the SRP Protocol if no session is in progress. 
<p>
If a session is already in progress, but the device is suspended, remote wakeup signaling is started. 
<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01896">1896</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<a class="anchor" name="517f9cf3e74ebb0b9e00ea1defc56697"></a><!-- doxytag: member="dwc_otg_pcd.c::dwc_otg_pcd_start_srp_timer" ref="517f9cf3e74ebb0b9e00ea1defc56697" args="(dwc_otg_pcd_t *pcd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dwc_otg_pcd_start_srp_timer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start the SRP timer to detect when the SRP does not complete within 6 seconds. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcd</em>&nbsp;</td><td>the pcd structure. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l01937">1937</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="c360aaa36ba28b977284fd482e7bc5ca"></a><!-- doxytag: member="dwc_otg_pcd.c::pcd_callbacks" ref="c360aaa36ba28b977284fd482e7bc5ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdwc__otg__cil__callbacks.html">dwc_otg_cil_callbacks_t</a> <a class="el" href="dwc__otg__pcd_8c.html#c360aaa36ba28b977284fd482e7bc5ca">pcd_callbacks</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .start = <a class="code" href="dwc__otg__pcd_8c.html#81693a91f25fb36b1443d3e597f9e59d">dwc_otg_pcd_start_cb</a>,
        .stop = <a class="code" href="dwc__otg__pcd_8c.html#00e06d719bfc4fa4c40c8a06a88eb052">dwc_otg_pcd_stop_cb</a>,
        .suspend = <a class="code" href="dwc__otg__pcd_8c.html#41a824bd34aa279d07ba3a17da35cf11">dwc_otg_pcd_suspend_cb</a>,
        .resume_wakeup = <a class="code" href="dwc__otg__pcd_8c.html#7bc757d00f936e5e308e950a17281675">dwc_otg_pcd_resume_cb</a>,
        .p = 0,                 
}
</pre></div>PCD Callback structure for handling mode switching. 
<p>

<p>
Definition at line <a class="el" href="dwc__otg__pcd_8c-source.html#l00216">216</a> of file <a class="el" href="dwc__otg__pcd_8c-source.html">dwc_otg_pcd.c</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue May 5 02:22:49 2009 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
